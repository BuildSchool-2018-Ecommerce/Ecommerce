@model ShoppingCartViewModel
@{
    ViewBag.Title = "Index";
    decimal total = 0.0M;
    foreach (var item in Model.ShoppingIconView)
    {
        if (item.Sale == 0)
        {
            total = total + (item.Quantity * item.UnitPrice);
        }
        else
        {
            total = total + (item.Quantity * item.Sale);
        }
    }
}

<style>
    .dollar {
        background-color: #f5f5f5;
        color: black;
        border: 0;
    }

    th, td {
        text-align: center;
    }

    .dollar:focus {
        outline: none;
    }
</style>

<!-- Header -->
<header class="header1">
    <!-- Header desktop -->
    <div class="container-menu-header">
        <div class="topbar">
            <div class="topbar-social">
                <a href="#" class="topbar-social-item fa fa-facebook"></a>
                <a href="#" class="topbar-social-item fa fa-instagram"></a>
                <a href="#" class="topbar-social-item fa fa-pinterest-p"></a>
                <a href="#" class="topbar-social-item fa fa-snapchat-ghost"></a>
                <a href="#" class="topbar-social-item fa fa-youtube-play"></a>
            </div>

            <span class="topbar-child1">
                Free shipping for standard order over $100
            </span>

            <div class="topbar-child2">
                <span class="topbar-email">
                    fashe@example.com
                </span>
            </div>
        </div>

        <div class="wrap_header">
            <!-- Logo -->
            <a href="index.html" class="logo">
                <img src="~/Content/images/icons/logo.png" alt="IMG-LOGO">
            </a>

            <!-- Menu -->
            <div class="wrap_menu">
                <nav class="menu">
                    <ul class="main_menu">
                        <li>
                            <a href="/Home/Index">Home</a>
                        </li>

                        <li>
                            <a href="/Shop/ShopHomePage">Shop</a>
                        </li>

                        <li>
                            <a href="product.html">Sale</a>
                        </li>

                        <li class="sale-noti">
                            <a href="/ShoppingCart/Cart">Features</a>
                        </li>

                        <li>
                            <a href="blog.html">Blog</a>
                        </li>

                        <li>
                            <a href="/Home/About">About</a>
                        </li>

                        <li>
                            <a href="/Home/Contact">Contact</a>
                        </li>
                    </ul>
                </nav>
            </div>

            <!-- Header Icon -->
            <div class="header-icons">
                @if (Model.User.Username == null)
                {
                    <a href="@Url.Action("LogIn", "Member")" class="header-wrapicon1 dis-block">
                        <img src="@Url.Content("~/Content/images/icons/icon-header-01.png")" class="header-icon1" alt="ICON">
                    </a>
                }
                else
                {
                    <div class="header-wrapicon2 m-r-13">
                        <img src="@Url.Content("~/Content/images/icons/00.png")" class="header-icon1 js-show-header-dropdown" alt="ICON">

                        <!-- Header cart noti -->
                        <div class="header-cart header-dropdown" style="width:160px;height:200px">
                            <ul class="header-cart-wrapitem">
                                <li class="header-cart-item">
                                    <div>
                                        <a href="@Url.Action("Account_Member","Member")" class="header-cart-item-name" style="color:royalblue">
                                            @Model.User.Username
                                        </a>
                                    </div>
                                </li>

                                <li class="header-cart-item">

                                    <div>

                                        <a href="@Url.Action("Account_UpdateMember","Member")" class="header-cart-item-name">
                                            <i class="far fa-edit"></i>
                                            修改會員
                                        </a>
                                    </div>
                                </li>

                                <li class="header-cart-item">

                                    <div>
                                        <a href="@Url.Action("Account_Order","Member")" class="header-cart-item-name">
                                            <i class="fas fa-search"></i>
                                            查詢訂單
                                        </a>
                                    </div>
                                </li>
                                <li class="header-cart-item">

                                    <div>
                                        <a href="@Url.Action("LogOut","Member")" class="header-cart-item-name">
                                            <i class="fas fa-sign-out-alt"></i>
                                            登出
                                        </a>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                }

                <span class="linedivide1"></span>

                <div class="header-wrapicon2">
                    <img src="~/Content/images/icons/icon-header-02.png" class="header-icon1 js-show-header-dropdown shop" alt="ICON">
                    <span class="header-icons-noti">0</span>

                    <!-- Header cart noti -->
                    <div class="header-cart header-dropdown shop">
                        <a href="/Member/LogIn"><i class="fas fa-sign-in-alt" style="margin-right:15px"></i>請登入會員</a>
                        @*<ul class="header-cart-wrapitem">
                                <li class="header-cart-item">
                                    <div class="header-cart-item-img">
                                        <img src="@Url.Content("~/Content/images/item-cart-01.jpg")" alt="IMG">
                                    </div>

                                    <div class="header-cart-item-txt">
                                        <a href="#" class="header-cart-item-name AutoSkip">
                                            White Shirt With Pleat Detail Back
                                        </a>

                                        <span class="header-cart-item-info">
                                            12 x $19.00
                                        </span>
                                    </div>
                                </li>

                                <li class="header-cart-item">
                                    <div class="header-cart-item-img">
                                        <img src="@Url.Content("~/Content/images/item-cart-02.jpg")" alt="IMG">
                                    </div>

                                    <div class="header-cart-item-txt">
                                        <a href="#" class="header-cart-item-name">
                                            Converse All Star Hi Black Canvas
                                        </a>

                                        <span class="header-cart-item-info">
                                            1 x $39.00
                                        </span>
                                    </div>
                                </li>

                                <li class="header-cart-item">
                                    <div class="header-cart-item-img">
                                        <img src="@Url.Content("~/Content/images/item-cart-03.jpg")" alt="IMG">
                                    </div>

                                    <div class="header-cart-item-txt">
                                        <a href="#" class="header-cart-item-name">
                                            Nixon Porter Leather Watch In Tan
                                        </a>

                                        <span class="header-cart-item-info">
                                            1 x $17.00
                                        </span>
                                    </div>
                                </li>
                            </ul>

                            <div class="header-cart-total Total">
                                Total: $75.00
                            </div>

                            <div class="header-cart-buttons">
                                <div class="header-cart-wrapbtn">
                                    <!-- Button -->
                                    <a href="/ShoppingCart/Index" class="flex-c-m size1 bg1 bo-rad-20 hov1 s-text1 trans-0-4">
                                        View Cart
                                    </a>
                                </div>

                                <div class="header-cart-wrapbtn">
                                    <!-- Button -->
                                    <a href="#" class="flex-c-m size1 bg1 bo-rad-20 hov1 s-text1 trans-0-4">
                                        Check Out
                                    </a>
                                </div>
                            </div>*@
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Header Mobile -->
    <div class="wrap_header_mobile">
        <!-- Logo moblie -->
        <a href="index.html" class="logo-mobile">
            <img src="~/Content/images/icons/logo.png" alt="IMG-LOGO">
        </a>
        
        <!-- Button show menu -->
        <div class="btn-show-menu">
            <!-- Header Icon mobile -->
            <div class="header-icons-mobile">
                @if (Model.User.Username == null)
                {
                    <a href="@Url.Action("LogIn", "Member")" class="header-wrapicon1 dis-block">
                        <img src="@Url.Content("~/Content/images/icons/icon-header-01.png")" class="header-icon1" alt="ICON">
                    </a>
                }
                else
                {
                    <div class="header-wrapicon2 m-r-13">
                        <img src="@Url.Content("~/Content/images/icons/00.png")" class="header-icon1 js-show-header-dropdown" alt="ICON">

                        <!-- Header cart noti -->
                        <div class="header-cart header-dropdown" style="width:160px;height:200px">
                            <ul class="header-cart-wrapitem">
                                <li class="header-cart-item">
                                    <div>
                                        <a href="@Url.Action("Account_Member","Member")" class="header-cart-item-name" style="color:royalblue">
                                            @Model.User.Username
                                        </a>
                                    </div>
                                </li>

                                <li class="header-cart-item">

                                    <div>

                                        <a href="@Url.Action("Account_UpdateMember","Member")" class="header-cart-item-name">
                                            <i class="far fa-edit"></i>
                                            修改會員
                                        </a>
                                    </div>
                                </li>

                                <li class="header-cart-item">

                                    <div>
                                        <a href="@Url.Action("Account_Order","Member")" class="header-cart-item-name">
                                            <i class="fas fa-search"></i>
                                            查詢訂單
                                        </a>
                                    </div>
                                </li>
                                <li class="header-cart-item">

                                    <div>
                                        <a href="@Url.Action("LogOut","Member")" class="header-cart-item-name">
                                            <i class="fas fa-sign-out-alt"></i>
                                            登出
                                        </a>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </div>
                }

                <span class="linedivide2"></span>

                <div class="header-wrapicon2">
                    <img src="~/Content/images/icons/icon-header-02.png" class="header-icon1 js-show-header-dropdown shop" alt="ICON">
                    <span class="header-icons-noti">0</span>

                    <!-- Header cart noti -->
                    <div class="header-cart header-dropdown shop">
                        <a href="/Member/LogIn"><i class="fas fa-sign-in-alt" style="margin-right:15px"></i>請登入會員</a>
                        @*<ul class="header-cart-wrapitem">
                                <li class="header-cart-item">
                                    <div class="header-cart-item-img">
                                        <img src="@Url.Content("~/Content/images/item-cart-01.jpg")" alt="IMG">
                                    </div>

                                    <div class="header-cart-item-txt">
                                        <a href="#" class="header-cart-item-name AutoSkip">
                                            White Shirt With Pleat Detail Back
                                        </a>

                                        <span class="header-cart-item-info">
                                            12 x $19.00
                                        </span>
                                    </div>
                                </li>

                                <li class="header-cart-item">
                                    <div class="header-cart-item-img">
                                        <img src="@Url.Content("~/Content/images/item-cart-02.jpg")" alt="IMG">
                                    </div>

                                    <div class="header-cart-item-txt">
                                        <a href="#" class="header-cart-item-name">
                                            Converse All Star Hi Black Canvas
                                        </a>

                                        <span class="header-cart-item-info">
                                            1 x $39.00
                                        </span>
                                    </div>
                                </li>

                                <li class="header-cart-item">
                                    <div class="header-cart-item-img">
                                        <img src="@Url.Content("~/Content/images/item-cart-03.jpg")" alt="IMG">
                                    </div>

                                    <div class="header-cart-item-txt">
                                        <a href="#" class="header-cart-item-name">
                                            Nixon Porter Leather Watch In Tan
                                        </a>

                                        <span class="header-cart-item-info">
                                            1 x $17.00
                                        </span>
                                    </div>
                                </li>
                            </ul>

                            <div class="header-cart-total Total">
                                Total: $75.00
                            </div>

                            <div class="header-cart-buttons">
                                <div class="header-cart-wrapbtn">
                                    <!-- Button -->
                                    <a href="/ShoppingCart/Index" class="flex-c-m size1 bg1 bo-rad-20 hov1 s-text1 trans-0-4">
                                        View Cart
                                    </a>
                                </div>

                                <div class="header-cart-wrapbtn">
                                    <!-- Button -->
                                    <a href="#" class="flex-c-m size1 bg1 bo-rad-20 hov1 s-text1 trans-0-4">
                                        Check Out
                                    </a>
                                </div>
                            </div>*@
                    </div>
                </div>
            </div>

            <div class="btn-show-menu-mobile hamburger hamburger--squeeze">
                <span class="hamburger-box">
                    <span class="hamburger-inner"></span>
                </span>
            </div>
        </div>
    </div>

    <!-- Menu Mobile -->
    <div class="wrap-side-menu">
        <nav class="side-menu">
            <ul class="main-menu">
                <li class="item-topbar-mobile p-l-20 p-t-8 p-b-8">
                    <span class="topbar-child1">
                        Free shipping for standard order over $100
                    </span>
                </li>

                <li class="item-topbar-mobile p-l-20 p-t-8 p-b-8">
                    <div class="topbar-child2-mobile">
                        <span class="topbar-email">
                            fashe@example.com
                        </span>
                    </div>
                </li>

                <li class="item-topbar-mobile p-l-10">
                    <div class="topbar-social-mobile">
                        <a href="#" class="topbar-social-item fa fa-facebook"></a>
                        <a href="#" class="topbar-social-item fa fa-instagram"></a>
                        <a href="#" class="topbar-social-item fa fa-pinterest-p"></a>
                        <a href="#" class="topbar-social-item fa fa-snapchat-ghost"></a>
                        <a href="#" class="topbar-social-item fa fa-youtube-play"></a>
                    </div>
                </li>

                <li class="item-menu-mobile">
                    <a href="/Home/Index">Home</a>
                </li>

                <li class="item-menu-mobile">
                    <a href="/Shop/ShopHomePage">Shop</a>
                </li>

                <li class="item-menu-mobile">
                    <a href="product.html">Sale</a>
                </li>

                <li class="item-menu-mobile">
                    <a href="/ShoppingCart/Cart">Features</a>
                </li>

                <li class="item-menu-mobile">
                    <a href="blog.html">Blog</a>
                </li>

                <li class="item-menu-mobile">
                    <a href="/Home/About">About</a>
                </li>

                <li class="item-menu-mobile">
                    <a href="/Home/Contact">Contact</a>
                </li>
            </ul>
        </nav>
    </div>
</header>

<!-- Title Page -->
<section class="bg-title-page p-t-50 p-b-40 flex-col-c-m" style="background-image: url(https://stmed.net/sites/default/files/elle-fanning-wallpapers-26656-4002211.jpg);">
    <h2 class="l-text2 t-center">
        R SEVEN
    </h2>
</section>

<!-- Cart -->
<section class="cart bgwhite p-t-70 p-b-100">
    <div class="container">
        <!-- Cart item -->
        <div class="container-table-cart pos-relative">
            <div class="wrap-table-shopping-cart bgwhite">
                <table class="table-shopping-cart">
                    <tr class="table-head">
                        <th style="width:150px;"></th>
                        <th style="width:200px;">Product</th>
                        <th style="width:80px;">Color</th>
                        <th style="width:80px;">Size</th>
                        <th>Price</th>
                        <th>Quantity</th>
                        <th>Total</th>
                        <th>DELETE</th>
                    </tr>
                    @foreach (var item in Model.ShoppingIconView)
                    {
                        <tr class="table-row">
                            <td style="padding-left:20px;width:150px;padding-right:20px;">
                                <div class="cart-img-product b-rad-4 o-f-hidden">
                                    <img src="@item.Image" alt="IMG-PRODUCT">
                                </div>
                            </td>
                            <td id="pn" style="width:200px">@item.ProductName</td>
                            <td style="width:80px">@item.Color</td>
                            <td style="width:80px">@item.Size</td>
                            @if (item.Sale == 0)
                            {
                                <td id="price">@item.UnitPrice.ToString("C", CultureInfo.CurrentCulture)</td>
                            }
                            else
                            {
                                <td id="price" style="color:red">@item.Sale.ToString("C", CultureInfo.CurrentCulture)</td>
                            }
                            <td style="width:200px;padding-left:30px;">
                                <div class="flex-w bo5 of-hidden w-size17">
                                    @if (item.Sale == 0)
                                    {
                                        <div id="price" hidden>@item.UnitPrice</div>
                                    }
                                    else
                                    {
                                        <div id="price" hidden>@item.Sale</div>
                                    }

                                    <button class="btn-num-product-down color1 flex-c-m size7 bg8 eff2">
                                        <i class="fs-12 fa fa-minus" aria-hidden="true"></i>
                                    </button>

                                    <input class="size8 m-text18 t-center num-product" type="number" name="num-product1" value="@item.Quantity">

                                    <button class="btn-num-product-up color1 flex-c-m size7 bg8 eff2">
                                        <i class="fs-12 fa fa-plus" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </td>
                            @if (item.Sale == 0)
                            {
                                var t = item.UnitPrice * item.Quantity;
                                <td id="to" style="width:200px;">@t.ToString("C", CultureInfo.CurrentCulture)</td>
                            }
                            else
                            {
                                var t = item.Sale * item.Quantity;
                                <td id="to" style="width:200px;">@t.ToString("C", CultureInfo.CurrentCulture)</td>
                            }
                            <td>
                                <input id="pfid" type="text" class="inpu" hidden value="@item.ProductFormatID" />
                                <button id="delete" class="btn btn-danger">
                                    <i class="fs-12 fa fa-trash" aria-hidden="true"></i>
                                </button>
                            </td>
                        </tr>
                    }
                    @*<tr class="table-row">
                            <td class="column-1">
                                <div class="cart-img-product b-rad-4 o-f-hidden">
                                    <img src="@Url.Content("~/Content/images/item-10.jpg")" alt="IMG-PRODUCT">
                                </div>
                            </td>
                            <td class="column-2">Men Tshirt</td>
                            <td class="column-3">$36.00</td>
                            <td class="column-4">
                                <div class="flex-w bo5 of-hidden w-size17">
                                    <button class="btn-num-product-down color1 flex-c-m size7 bg8 eff2">
                                        <i class="fs-12 fa fa-minus" aria-hidden="true"></i>
                                    </button>

                                    <input class="size8 m-text18 t-center num-product" type="number" name="num-product1" value="1">

                                    <button class="btn-num-product-up color1 flex-c-m size7 bg8 eff2">
                                        <i class="fs-12 fa fa-plus" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </td>
                            <td class="column-5">$36.00</td>
                        </tr>

                        <tr class="table-row">
                            <td class="column-1">
                                <div class="cart-img-product b-rad-4 o-f-hidden">
                                    <img src="@Url.Content("~/Content/images/item-05.jpg")" alt="IMG-PRODUCT">
                                </div>
                            </td>
                            <td class="column-2">Mug Adventure</td>
                            <td class="column-3">$16.00</td>
                            <td class="column-4">
                                <div class="flex-w bo5 of-hidden w-size17">
                                    <button class="btn-num-product-down color1 flex-c-m size7 bg8 eff2">
                                        <i class="fs-12 fa fa-minus" aria-hidden="true"></i>
                                    </button>

                                    <input class="size8 m-text18 t-center num-product" type="number" name="num-product2" value="1">

                                    <button class="btn-num-product-up color1 flex-c-m size7 bg8 eff2">
                                        <i class="fs-12 fa fa-plus" aria-hidden="true"></i>
                                    </button>
                                </div>
                            </td>
                            <td class="column-5">$16.00</td>
                        </tr>*@
                </table>
            </div>
        </div>

        <div class="flex-w flex-sb-m p-t-25 p-b-25 bo8 p-l-35 p-r-60 p-lr-15-sm">
            <h5 id="error" style="color:red;flex: 0 0 100%;text-align:center;"></h5>
            <div class="flex-w flex-m w-full-sm">
                <div class="size11 bo4 m-r-10">
                    <input class="sizefull s-text7 p-l-22 p-r-22" type="text" name="coupon-code" placeholder="Coupon Code">
                </div>

                <div class="size12 trans-0-4 m-t-10 m-b-10 m-r-10">
                    <!-- Button -->
                    <button class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4">
                        Apply coupon
                    </button>
                </div>
            </div>

            <div class="size10 trans-0-4 m-t-10 m-b-10">
                <!-- Button -->
                <button id="update" class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4">
                    Update Cart
                </button>
            </div>
        </div>

        <div class="size15 trans-0-4">

            <!-- Button -->
            <button id="check" class="flex-c-m bg1 bo-rad-23 hov1 s-text1 trans-0-4" style="width:15%;height:100%;margin-left:80%;margin-top:30px;">
                Checkout
            </button>
        </div>
        <!-- Total -->
        @*<div class="bo9 w-size18 p-l-40 p-r-40 p-t-30 p-b-38 m-t-30 m-r-0 m-l-auto p-lr-15-sm">
                <h5 class="m-text20 p-b-24">
                    Cart Totals
                </h5>

                <!--  -->
                <div class="flex-w flex-sb-m p-b-12">
                    <span class="s-text18 w-size19 w-full-sm">
                        Subtotal:
                    </span>

                    <span class="m-text21 w-size20 w-full-sm">
                        @total.ToString("C", CultureInfo.CurrentCulture)
                    </span>
                </div>

                <!--  -->
                <div class="flex-w flex-sb bo10 p-t-15 p-b-20">
                    <span class="s-text18 w-size19 w-full-sm">
                        Shipping:
                    </span>

                    <div class="w-size20 w-full-sm">
                        <p class="s-text8 p-b-23">
                            There are no shipping methods available. Please double check your address, or contact us if you need any help.
                        </p>

                        <span class="s-text19">
                            Calculate Shipping
                        </span>

                        <div class="rs2-select2 rs3-select2 rs4-select2 bo4 of-hidden w-size21 m-t-8 m-b-12">
                            <select class="selection-2" name="country" style="width: 100%">
                                <option>Select a country...</option>
                                <option>US</option>
                                <option>UK</option>
                                <option>Japan</option>
                            </select>
                        </div>

                        <div class="size13 bo4 m-b-12">
                            <input class="sizefull s-text7 p-l-15 p-r-15" type="text" name="state" placeholder="State /  country">
                        </div>

                        <div class="size13 bo4 m-b-22">
                            <input class="sizefull s-text7 p-l-15 p-r-15" type="text" name="postcode" placeholder="Postcode / Zip">
                        </div>

                        <div class="size14 trans-0-4 m-b-10">
                            <!-- Button -->
                            <button class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4">
                                Update Totals
                            </button>
                        </div>
                    </div>
                </div>

                <!--  -->
                <div class="flex-w flex-sb-m p-t-26 p-b-30">
                    <span class="m-text22 w-size19 w-full-sm">
                        Total:
                    </span>

                    <span class="m-text21 w-size20 w-full-sm">
                        @total.ToString("C", CultureInfo.CurrentCulture)
                    </span>
                </div>

                <div class="size15 trans-0-4">
                    <!-- Button -->
                    <button class="flex-c-m sizefull bg1 bo-rad-23 hov1 s-text1 trans-0-4">
                        Proceed to Checkout
                    </button>
                </div>
            </div>*@
    </div>
</section>

<!-- Back to top -->
<div class="btn-back-to-top bg0-hov" id="myBtn">
    <span class="symbol-btn-back-to-top">
        <i class="fa fa-angle-double-up" aria-hidden="true"></i>
    </span>
</div>

<!-- Container Selection -->
<div id="dropDownSelect1"></div>
<div id="dropDownSelect2"></div>

@Scripts.Render("~/Content/vendors")
@Scripts.Render("~/Content/vendors1")
@Scripts.Render("~/Content/js")
@*<script type="text/javascript" src="vendor/select2/select2.min.js"></script>*@
<script type="text/javascript">
    //$(".selection-1").select2({
    //    minimumResultsForSearch: 20,
    //    dropdownParent: $('#dropDownSelect1')
    //});

    //$(".selection-2").select2({
    //    minimumResultsForSearch: 20,
    //    dropdownParent: $('#dropDownSelect2')
    //});
    $(document).on('click', '#check', function (e) {
        location.href = "/ShoppingCart/CheckOut";
    });
    $(document).on('click', '.btn-num-product-down', function (e) {
        find(e.target);
    });
    $(document).on('click', '#update', function (e) {
        console.log($('.num-product'));
        console.log($('.inpu'));
        var num = $('.num-product');
        var input = $('.inpu');
        var a = {
            Quantity: [],
            ProductFormatID: []
        }
        for (var item of num) {
            a.Quantity.push($(item).val());
        }
        for (var item of input) {
            a.ProductFormatID.push($(item).val());
        }
        console.log(a);
        var json = JSON.stringify(a);
        $.ajax({
            url: "/ShoppingCart/Update",
            data: {
                shop: json
            },
            success: function (result) {
                location.href = "/ShoppingCart/Cart";
            }
            , error: function (result) {
                var error = result.responseText;
                var s = error.split(",");
                var inp = $('.inpu');
                for (var item of inp) {
                    if ($(item).val() == s[1]) {
                        var n = $(item).parents('tr').find('#pn').text();
                        console.log(n);
                        $('#error').text(s[0] + " (" + n + ") 剩餘數量:"+s[2]);
                    }
                }
            }
        });
    });
    $(document).on('click', '#delete', function (e) {
        var del = confirm('確定刪除?');
        if (del == true) {
            var id = $(e.target).parents('td').find('#pfid').val();
            $.ajax({
                url: "/ShoppingCart/DeleteProduct",
                data: {
                    pfid: id
                },
                success: function (result) {
                    $(e.target).parents('tr').remove();
                },
                error: function () {
                    alert("刪除失敗!");
                }
            })
        }
    });
    $(document).on('click', '.btn-num-product-up', function (e) {
        find(e.target);
    });
    $(document).on('change', '.num-product', function (e) {
        if (e.target.value == 0) {
            e.target.value = 1;
        }
        find(e.target);
    });
    var find = function (result) {
        var price = parseInt($(result).parents('td').find('#price').text());
        var quantity = parseInt($(result).parents('td').find('input').val());
        var to = $(result).parents('tr').find("#to");
        var all = price * quantity;
        var total = dealNumber(all);
        to.text('NT$' + total);
    };
    var dealNumber = function (money) {
        if (money && money != null) {
            money = String(money);
            var left = money.split('.')[0], right = money.split('.')[1];
            right = right ? (right.length >= 2 ? '.' + right.substr(0, 2) : '.' + right + '0') : '.00';
            var temp = left.split('').reverse().join('').match(/(\d{1,3})/g);
            return (Number(money) < 0 ? "-" : "") + temp.join(',').split('').reverse().join('') + right;
        } else if (money === 0) {   //注意===在这里的使用，如果传入的money为0,if中会将其判定为boolean类型，故而要另外做===判断
            return '0.00';
        } else {
            return "";
        }
    };
    $('.js-show-header-dropdown.shop').click(function () {
        //if ($('#user').length == 0) {
        //    location.href = "/Member/LogIn";
        //}
        console.log($(this));
        $.ajax({
            url: "/ShoppingCart/ShoppingBar",
            success: function (result) {
                $('.header-dropdown.shop').empty();
                $('.header-dropdown.shop').html(result);
            }
        });
    });
</script>

